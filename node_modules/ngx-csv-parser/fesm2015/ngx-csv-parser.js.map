{"version":3,"file":"ngx-csv-parser.js","sources":["ng://ngx-csv-parser/lib/_model/ngx-csv-parser-error.interface.ts","ng://ngx-csv-parser/lib/ngx-csv-parser.service.ts","ng://ngx-csv-parser/lib/ngx-csv-parser.component.ts","ng://ngx-csv-parser/lib/ngx-csv-parser.module.ts","ng://ngx-csv-parser/public-api.ts","ng://ngx-csv-parser/ngx-csv-parser.ts"],"sourcesContent":["export class NgxCSVParserError {\r\n    type: string;     // A generalization of the error\r\n    code: number;     // Standardized error code\r\n    message: string;  // Human-readable details\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { Observable, Observer } from 'rxjs';\r\nimport { NgxCSVParserError } from './_model/ngx-csv-parser-error.interface';\r\n\r\n@Injectable({\r\n    providedIn: 'root'\r\n})\r\nexport class NgxCsvParser {\r\n\r\n    constructor() {\r\n        console.log(`\r\n      *****************************************************\r\n      ***      For Custom Software/Web development      ***\r\n      *** Reach out to us at contact@developershive.com ***\r\n      ***  Support us https://patreon.com/tofiqquadri/  ***\r\n      ***     Visit us at https://developershive.com    ***\r\n      *****************************************************\r\n    `);\r\n    }\r\n\r\n    private defaultCSVParserConfig = {\r\n        header: true,\r\n        delimiter: ','\r\n    };\r\n\r\n    parse(csvFile: File, config: CSVParserConfig): Observable<Array<any> | NgxCSVParserError> {\r\n\r\n        config = {\r\n            ...this.defaultCSVParserConfig,\r\n            ...config\r\n        };\r\n\r\n        const ngxCSVParserObserver = new Observable((observer: Observer<Array<any> | NgxCSVParserError>) => {\r\n            try {\r\n                let csvRecords = null;\r\n\r\n                if (this.isCSVFile(csvFile)) {\r\n\r\n                    const reader = new FileReader();\r\n                    reader.readAsText(csvFile);\r\n\r\n                    reader.onload = () => {\r\n                        const csvData = reader.result;\r\n                        const csvRecordsArray = this.csvStringToArray((csvData as string).trim(), config.delimiter);\r\n\r\n                        const headersRow = this.getHeaderArray(csvRecordsArray);\r\n\r\n                        csvRecords = this.getDataRecordsArrayFromCSVFile(csvRecordsArray, headersRow.length, config);\r\n\r\n                        observer.next(csvRecords);\r\n                        observer.complete();\r\n                    };\r\n\r\n                    reader.onerror = () => {\r\n                        this.badCSVDataFormatErrorHandler(observer);\r\n                    };\r\n\r\n                } else {\r\n                    this.notCSVFileErrorHandler(observer);\r\n                }\r\n\r\n            } catch (error) {\r\n                this.unknownCSVParserErrorHandler(observer);\r\n            }\r\n        });\r\n\r\n        return ngxCSVParserObserver;\r\n    }\r\n\r\n    csvStringToArray(csvDataString: string, delimiter: string) {\r\n        const regexPattern = new RegExp((`(\\\\${delimiter}|\\\\r?\\\\n|\\\\r|^)(?:\\\"((?:\\\\\\\\.|\\\"\\\"|[^\\\\\\\\\\\"])*)\\\"|([^\\\\${delimiter}\\\"\\\\r\\\\n]*))`), \"gi\")\r\n        let matchedPatternArray = regexPattern.exec(csvDataString);\r\n        const resultCSV = [[]];\r\n        while (matchedPatternArray) {\r\n            if (matchedPatternArray[1].length && matchedPatternArray[1] !== delimiter) {\r\n                resultCSV.push([]);\r\n            }\r\n            const cleanValue = matchedPatternArray[2] ?\r\n                matchedPatternArray[2].replace(new RegExp(\"[\\\\\\\\\\\"](.)\", \"g\"), '$1') : matchedPatternArray[3];\r\n            resultCSV[resultCSV.length - 1].push(cleanValue);\r\n            matchedPatternArray = regexPattern.exec(csvDataString);\r\n        }\r\n        return resultCSV;\r\n    }\r\n\r\n    getDataRecordsArrayFromCSVFile(csvRecordsArray: any, headerLength: any, config: any) {\r\n        const dataArr = [];\r\n        const headersArray = csvRecordsArray[0];\r\n\r\n        const startingRowToParseData = config.header ? 1 : 0;\r\n\r\n        for (let i = startingRowToParseData; i < csvRecordsArray.length; i++) {\r\n            const data = csvRecordsArray[i];\r\n\r\n            if (data.length === headerLength && config.header) {\r\n\r\n                const csvRecord = {};\r\n\r\n                for (let j = 0; j < data.length; j++) {\r\n                    if ((data[j] === undefined) || (data[j] === null)) {\r\n                        csvRecord[headersArray[j]] = \"\";\r\n                    } else {\r\n                        csvRecord[headersArray[j]] = data[j].trim();\r\n                    }\r\n                }\r\n                dataArr.push(csvRecord);\r\n            } else {\r\n                dataArr.push(data);\r\n            }\r\n        }\r\n        return dataArr;\r\n    }\r\n\r\n    isCSVFile(file: any) {\r\n        return file.name.endsWith('.csv');\r\n    }\r\n\r\n    getHeaderArray(csvRecordsArr: any) {\r\n        const headers = csvRecordsArr[0];\r\n        const headerArray = [];\r\n        for (const header of headers) {\r\n            headerArray.push(header);\r\n        }\r\n        return headerArray;\r\n    }\r\n\r\n    notCSVFileErrorHandler(observer: Observer<any>) {\r\n        const ngcCSVParserError: NgxCSVParserError =\r\n            this.errorBuilder('NOT_A_CSV_FILE', 'Selected file is not a csv File Type.', 2);\r\n        observer.error(ngcCSVParserError);\r\n    }\r\n\r\n    unknownCSVParserErrorHandler(observer: Observer<any>) {\r\n        const ngcCSVParserError: NgxCSVParserError =\r\n            this.errorBuilder('UNKNOWN_ERROR', 'Unknown error. Please refer to official documentation for library usage.', 404);\r\n        observer.error(ngcCSVParserError);\r\n    }\r\n\r\n    badCSVDataFormatErrorHandler(observer: Observer<any>) {\r\n        const ngcCSVParserError: NgxCSVParserError =\r\n            this.errorBuilder('BAD_CSV_DATA_FORMAT', 'Unable to parse CSV File.', 1);\r\n        observer.error(ngcCSVParserError);\r\n    }\r\n\r\n    errorBuilder(type: string, message: any, code: any): NgxCSVParserError {\r\n        const ngcCSVParserError: NgxCSVParserError = new NgxCSVParserError();\r\n        ngcCSVParserError.type = type;\r\n        ngcCSVParserError.message = message;\r\n        ngcCSVParserError.code = code;\r\n        return ngcCSVParserError;\r\n    }\r\n}\r\n\r\nclass CSVParserConfig {\r\n    header?: boolean;\r\n    delimiter?: string;\r\n\r\n    constructor() { }\r\n}\r\n","import { Component, OnInit } from '@angular/core';\n\n@Component({\n  selector: 'lib-ngx-csv-parser',\n  template: `\n    <p>\n      ngx-csv-parser works!\n    </p>\n  `,\n  styles: []\n})\nexport class NgxCsvParserComponent implements OnInit {\n\n  constructor() { }\n\n  ngOnInit() {\n  }\n\n}\n","import { NgModule } from '@angular/core';\nimport { NgxCsvParserComponent } from './ngx-csv-parser.component';\nimport { NgxCsvParser } from './ngx-csv-parser.service';\n\n@NgModule({\n  declarations: [NgxCsvParserComponent],\n  imports: [\n  ],\n  providers: [NgxCsvParser],\n  exports: [NgxCsvParserComponent]\n})\nexport class NgxCsvParserModule { }\n","/*\n * Public API Surface of ngx-csv-parser\n */\n\nexport * from './lib/ngx-csv-parser.service';\nexport * from './lib/_model/ngx-csv-parser-error.interface';\nexport * from './lib/ngx-csv-parser.component';\nexport * from './lib/ngx-csv-parser.module';\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public-api';\n"],"names":[],"mappings":"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"}